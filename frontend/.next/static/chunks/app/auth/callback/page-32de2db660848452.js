(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[769],{3021:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var r=a(5155),i=a(2115),s=a(81),n=a(5695),o=a(9465);let l=a(9509).env.NEXT_PUBLIC_BACKEND_URL||"https://backend-0dlk.onrender.com";function c(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)(),{refreshUser:a}=(0,o.A)(),[c,d]=(0,i.useState)("Processing authentication..."),[u,h]=(0,i.useState)("");return(0,i.useEffect)(()=>{(async()=>{try{let r=t.get("code"),i=t.get("error");if(i)return void h("Authentication failed: ".concat(i));if(!r)return void h("No authorization code received");d("Completing authentication...");let s=await fetch("".concat(l,"/api/auth/callback?code=").concat(r),{method:"GET",credentials:"include"});if(s.ok)d("Authentication successful! Redirecting..."),await a(),setTimeout(()=>{e.push("/")},1500);else{let e=await s.json();h(e.error||"Authentication failed")}}catch(e){console.error("Callback error:",e),h("An unexpected error occurred during authentication")}})()},[t,e,a]),(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-[#051A05] via-[#0A2A0A] to-[#051A05] flex items-center justify-center p-4",children:(0,r.jsxs)(s.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"w-full max-w-md",children:[(0,r.jsxs)("div",{className:"text-center mb-8",children:[(0,r.jsx)(s.P.div,{className:"w-16 h-16 bg-gradient-to-r from-[#00FFC2] to-[#00FFC2]/80 rounded-2xl flex items-center justify-center mx-auto mb-6",animate:{scale:[1,1.1,1],rotate:[0,5,-5,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:(0,r.jsx)("svg",{className:"w-8 h-8 text-black",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Authentication"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Please wait while we complete your sign-in"})]}),(0,r.jsx)(s.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"bg-black/30 backdrop-blur-md rounded-2xl border border-white/10 shadow-2xl p-8",children:u?(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-red-500/20 border border-red-500/30 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:"Authentication Failed"}),(0,r.jsx)("p",{className:"text-red-400 mb-6",children:u}),(0,r.jsx)(s.P.button,{onClick:()=>e.push("/auth/login"),whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-6 py-3 bg-gradient-to-r from-[#00FFC2] to-[#00FFC2]/90 text-black font-semibold rounded-lg hover:from-[#00FFC2]/90 hover:to-[#00FFC2] transition-all duration-300 shadow-lg",children:"Try Again"})]}):(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-[#00FFC2]/20 border border-[#00FFC2]/30 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)(s.P.svg,{className:"w-6 h-6 text-[#00FFC2]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-white mb-2",children:"Processing"}),(0,r.jsx)("p",{className:"text-gray-300 mb-6",children:c}),(0,r.jsxs)("div",{className:"flex justify-center",children:[(0,r.jsx)(s.P.div,{className:"w-2 h-2 bg-[#00FFC2] rounded-full mx-1",animate:{scale:[1,1.5,1],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,ease:"easeInOut"}}),(0,r.jsx)(s.P.div,{className:"w-2 h-2 bg-[#00FFC2] rounded-full mx-1",animate:{scale:[1,1.5,1],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,ease:"easeInOut",delay:.2}}),(0,r.jsx)(s.P.div,{className:"w-2 h-2 bg-[#00FFC2] rounded-full mx-1",animate:{scale:[1,1.5,1],opacity:[.5,1,.5]},transition:{duration:1,repeat:1/0,ease:"easeInOut",delay:.4}})]})]})})]})})}},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},9465:(e,t,a)=>{"use strict";let r,i,s;a.d(t,{A:()=>m,AuthProvider:()=>h});var n=a(5155),o=a(2115),l=a(3915),c=a(6203),d=a(9509);try{r=(0,l.Wp)({apiKey:"AIzaSyA40wiXOqkqSCpHrzhgjdKuO056G1yjIv0",authDomain:"supeai-6da3b.firebaseapp.com",databaseURL:"https://supeai-6da3b-default-rtdb.firebaseio.com",projectId:"supeai-6da3b",storageBucket:"supeai-6da3b.appspot.com",messagingSenderId:"114747954289",appId:"1:114747954289:web:e7d2f5d6f2c5c5c5c5c5c5"}),i=(0,c.xI)(r),s=new c.HF}catch(e){console.error("Firebase initialization error (non-critical):",e.message)}let u=(0,o.createContext)({});function h(e){let{children:t}=e,[a,r]=(0,o.useState)(null),[l,h]=(0,o.useState)(!0);(0,o.useEffect)(()=>{if(!i){console.warn("Auth not initialized, but continuing..."),h(!1);return}m();let e=i.onAuthStateChanged(e=>{e?r({...e,emailVerified:e.emailVerified}):r(null),h(!1)});return()=>e()},[]);let m=async()=>{try{let e=await fetch("/api/auth/session",{credentials:"include"}),t=await e.json();t.user?r(t.user):r(null)}catch(e){console.error("Session check error:",e),r(null)}h(!1)},f=async e=>{let t=null;try{t=await (0,c.eJ)(i,e.email,e.password),await (0,c.gA)(t.user);let a=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,firebaseUid:t.user.uid})});if(!a.ok){let e=await a.json();if(t&&t.user)try{await t.user.delete(),console.log("Firebase user deleted due to backend signup failure")}catch(e){console.error("Failed to delete Firebase user:",e)}throw Error(e.message||"Failed to sign up")}return{...await a.json(),verificationEmailSent:!0}}catch(e){if(console.error("Signup error:",e),"auth/email-already-in-use"===e.code)throw Error("This email is already registered. Please log in or use a different email.");if(t&&t.user&&"This email is already registered. Please log in or use a different email."!==e.message)try{await t.user.delete(),console.log("Firebase user cleaned up after signup error")}catch(e){console.error("Failed to delete Firebase user during cleanup:",e)}throw e}},p=async(e,t)=>{try{let a=await (0,c.x9)(i,e,t);if(!a.user.emailVerified)throw await (0,c.gA)(a.user),Error("Please verify your email address. A new verification email has been sent.");let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t,firebaseUid:a.user.uid})});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to login")}let n=await s.json();return r({...n.user,emailVerified:a.user.emailVerified}),n}catch(e){throw console.error("Login error:",e),e}},g=async()=>{try{let e=(await (0,c.df)(i,s)).user,t=await e.getIdToken(),a=d.env.NEXT_PUBLIC_BACKEND_URL||"https://backend-0dlk.onrender.com",r=await fetch("".concat(a,"/auth/google"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:t}),credentials:"include"});if(!r.ok){let e=await r.json();throw Error(e.message||"Failed to sign in with Google")}return await m(),!0}catch(e){throw console.error("Google sign-in error:",e),e}},x=async()=>{try{await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),await i.signOut(),r(null)}catch(e){throw console.error("Logout error:",e),e}},w=async()=>{if(!i.currentUser)throw Error("No user is currently signed in");await (0,c.gA)(i.currentUser)};return(0,n.jsx)(u.Provider,{value:{user:a,loading:l,signUp:f,login:p,signInWithGoogle:g,logout:x,resendVerificationEmail:w},children:!l&&t})}let m=()=>(0,o.useContext)(u)},9622:(e,t,a)=>{Promise.resolve().then(a.bind(a,3021))}},e=>{var t=t=>e(e.s=t);e.O(0,[811,81,853,441,684,358],()=>t(9622)),_N_E=e.O()}]);